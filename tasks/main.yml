---
- name:       Looking for JumpCloud Agent Config exists
  stat:
    path:     "{{ jumpcloud_agent_config }}"
  register:   jumpcloud_agent_config_status

- name:       Determine if JumpCloud is already installed
  set_fact:
    jumpcloud_not_installed: "{{ not (jumpcloud_agent_config_status.stat.isreg is defined and jumpcloud_agent_config_status.stat.isreg) }}"

- name:       Install JumpCloud if required
  include:    install.yml
  when:       not jumpcloud_not_installed or jumpcloud_force_install

- name:       Checking again the JumpCloud installation status
  set_fact:
    jumpcloud_is_installed: "{{ jumpcloud_agent_config_status.stat.isreg is defined and jumpcloud_agent_config_status.stat.isreg }}"

- name:       Update System Attributes if JumpCloud is insalled
  include:    update_system.yml
  when:       jumpcloud_is_installed
...
